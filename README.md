<h1 align="center">Strapi</h1>

<h3 align="center">
A strapi project with support for MySQL, Digitalocean Spaces, Docker and Docker Compose.
</h3>

<br>

<p align="center">
  <img src="https://img.shields.io/badge/Node%20js-14.17.0-3c730f?style=for-the-badge&logo=node.js&labelColor=20232a" />
  <img src="https://img.shields.io/badge/strapi-3.6.8-35408a?style=for-the-badge&logo=strapi&labelColor=20232a" />
  <a href="https://hub.docker.com/r/luisfalconmx/strapi">
    <img src="https://img.shields.io/endpoint?url=https://gist.githubusercontent.com/luisfalconmx/a5061f5a6d416bf2228bedc05f8dfa1b/raw/docker-badge.json" />
  </a>
  <a href="https://github.com/luisfalconmx/strapi/blob/main/LICENSE">
    <img src="https://img.shields.io/badge/license-MIT-orange?style=for-the-badge&logo=github&labelColor=20232a" />
  </a>
</p>

<br>

<p align="center">
  <img src="https://raw.githubusercontent.com/luisfalconmx/strapi/main/docs/images/strapi-cover.png" />
</p>

<br><br>

## Getting Started

The image in this project uses strapi in its base to function. It is complemented by a self-administered database in mongodb atlas. You can view the requirements in this document to obtain the credentials of the environment variables.

<br>

## Enviroment Variables

The following variables are available to configure the project, database, and static file storage for a production environment:

|       Variable        |  Type   | Required | Default |                        Description                         |
| :-------------------: | :-----: | :------: | :-----: | :--------------------------------------------------------: |
|        `HOST`         | string  |  false   | 0.0.0.0 |                        Set the host                        |
|        `PORT`         | number  |  false   |  2336   |                        Set the port                        |
|         `URL`         | string  |   true   |         |             Set the static url of the project              |
|  `ADMIN_JWT_SECRET`   | string  |   true   |         |      Sets the main security token generated by strapi      |
|    `DATABASE_HOST`    | number  |   true   |         |               Sets the host for the database               |
|    `DATABASE_PORT`    | number  |  false   |  3306   |               Sets the port for the database               |
|    `DATABASE_NAME`    | string  |  false   | strapi  |                   Sets the database name                   |
|  `DATABASE_USERNAME`  | string  |   true   |         | Sets the username that will be used to access the database |
|  `DATABASE_PASSWORD`  | string  |   true   |         | Sets the password that will be used to access the database |
|    `DATABASE_SSL`     | boolean |  false   |  false  | Sets the password that will be used to access the database |
| `DO_SPACE_ACCESS_KEY` | string  |   true   |         |       Sets the access key for the digitalocean space       |
| `DO_SPACE_SECRET_KEY` | string  |   true   |         |       Sets the secret key for the digitalocean space       |
|  `DO_SPACE_ENDPOINT`  | string  |   true   |         |      Specifies the endpoint of the digitalocean space      |
|   `DO_SPACE_BUCKET`   | string  |   true   |         |        Specifies the name of the digitalocean space        |
| `DO_SPACE_DIRECTORY`  | string  |  false   |    /    | Specify the directory where the static files will be saved |
|    `DO_SPACE_CDN`     | string  |  false   |         |     Specify the domain you will use to enable the CDN      |

### Run the project with the Dockerhub Image

```
docker run --name strapi -p 1337:1337 \
-e DATABASE_HOST= \
-e DATABASE_SRV=true \
-e DATABASE_NAME= \
-e DATABASE_USERNAME= \
-e DATABASE_PASSWORD= \
-e DATABASE_SSL=true \
-e ADMIN_JWT_SECRET= \
-e AWS_ACCESS_KEY_ID= \
-e AWS_ACCESS_SECRET= \
-e AWS_REGION= \
-e AWS_BUCKET= \
luisfalconmx/strapi:latest
```

<br>

### Run the project with the image from Github Package Registry

```
docker run --name strapi -p 1337:1337 \
-e DATABASE_HOST= \
-e DATABASE_SRV=true \
-e DATABASE_NAME= \
-e DATABASE_USERNAME= \
-e DATABASE_PASSWORD= \
-e DATABASE_SSL=true \
-e ADMIN_JWT_SECRET= \
-e AWS_ACCESS_KEY_ID= \
-e AWS_ACCESS_SECRET= \
-e AWS_REGION= \
-e AWS_BUCKET= \
ghcr.io/luisfalconmx/strapi:latest
```

<br>

### Run the project with Docker Compose

Create a `.env` file in current directory and pass value to `ADMIN_JWT_SECRET` variable.

Now run `docker-compose up`

<br>

## Requeriments

In order to use the image of this project, the following requirements need to be met.

- [Docker installed on your computer or on your server](https://docs.docker.com/engine/install/)
- [Docker compose installed on your computer](https://docs.docker.com/compose/install/)
- [An account on MongoDB Atlas](https://www.mongodb.com/cloud/atlas)
- [An account on AWS](https://aws.amazon.com/)

<br>

## Releases

List of published versions: https://github.com/luisfalconmx/strapi/releases

<br>

## License and Code of Conduct

- [MIT License](https://github.com/luisfalconmx/strapi/blob/main/LICENSE)
- [Code of Conduct](https://github.com/luisfalconmx/strapi/blob/main/CODE_OF_CONDUCT.md)
